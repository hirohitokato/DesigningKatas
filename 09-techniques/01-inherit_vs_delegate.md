---
marp: true
math: mathjax
theme: katas
---
<!-- 
size: 16:9
paginate: true
-->
<!-- header: 勉強会# ― エンジニアとしての解像度を高めるための勉強会-->

# 継承と委譲の使い分け

_Inheritance vs delegation_

---

## 継承とは、委譲とは

- **継承**:
    - 既存のクラス(親クラス)をもとに新しい別のクラス(子クラス)を作り、親の責務を受け継ぐこと
- **委譲**:
    - あるクラスの振る舞いを別のクラスに委ねること

---

## 継承 / 委譲

```py
# 継承
class Base:
    …
class Derived(Base):
    # 親のメソッドやプロパティを利用できる
```

```py
# 委譲
class Leg:
    def move(self): …

class Child {
    def init(self):
        my_leg = Leg()
    def move(self):
        my_leg.move()
```

---

## 使い分け

「is-a」の関係であれば継承、「has-a/use-a」の場合は委譲（がベター）。
 
> - 子にとって親は単なるツールである場合は委譲を使うのが良い。継承してしまうと子が複数の責務を負うことになり、そのことによる不都合が生じる。
> - 逆に、子が親と同じ責務を持つべき場合には継承を使う。委譲を使うと、子が親と同じ能力を持っていないことによる不都合が生じる。

期待される役割が同じ場合は継承、違う場合は委譲を使うとしっくりくることが多い

>>> ブログ記事「[継承と委譲の使い分けと、インターフェースの重要性について](https://ikenox.info/blog/inheritance-delegation-interface/)」から引用
 
---

## 継承のデメリット

- コードが読みにくくなる
- すぐ神クラスになる
- 変な継承をする人がいる

<!-- https://mametter.hatenablog.com/entry/2024/02/10/120527 -->
---

## 判断のきっかけ

- **設計時**：期待される役割について考える / 「同じ処理を使うから」はそういう役割を持つクラスを作って委譲する
- **違反の臭い**：使わないメソッドが多くある。親クラスに処理がどんどん集まっている
- **リファクタリング**：親クラスを薄くする。クラス(実装)の継承ではなく、インターフェースの継承を使う
 
---
## クイズ

1. StringクラスとCharacterクラスの関係を表すには継承、委譲のどちらがふさわしいか？
   - 答え: 委譲。文字列クラスは文字（character）の集まりであるため、StringクラスはCharacterクラスを内部に含むことが適切です。

2. 自動車とエンジンの関係を表すには継承、委譲のどちらがふさわしいか？
   - 答え: 委譲。自動車はエンジンを持ちますが、自動車はエンジンそのものではありません。そのため、自動車クラスがエンジンクラスのインスタンスを持つことが適切です。

3. 動物と猫の関係を表すには継承、委譲のどちらがふさわしいか？
   - 答え: 継承。猫は動物であり、動物の一種です。そのため、猫クラスが動物クラスを継承することが適切です。

4. 魚と水槽の関係を表すには継承、委譲のどちらがふさわしいか？
   - 答え: 委譲。水槽は魚を含むものですが、水槽自体が魚ではありません。そのため、水槽クラスが魚クラスを内部に持つことが適切です。

5. 会社と従業員の関係を表すには継承、委譲のどちらがふさわしいか？
   - 答え: 委譲。従業員は会社に所属しますが、従業員は会社そのものではありません。そのため、会社クラスが従業員クラスを内部に持つことが適切です。
1. 図形と円の関係を表すには継承、委譲のどちらがふさわしいか？
   - 答え: 継承。円は図形の一種であり、図形クラスが円クラスを継承することが適切です。

2. 動物と犬の関係を表すには継承、委譲のどちらがふさわしいか？
   - 答え: 継承。犬は動物の一種であり、犬クラスが動物クラスを継承することが適切です。

3. 車とトラックの関係を表すには継承、委譲のどちらがふさわしいか？
   - 答え: 継承。トラックは車の一種であり、トラッククラスが車クラスを継承することが適切です。

4. 家具と椅子の関係を表すには継承、委譲のどちらがふさわしいか？
   - 答え: 継承。椅子は家具の一種であり、椅子クラスが家具クラスを継承することが適切です。

5. 人間と子供の関係を表すには継承、委譲のどちらがふさわしいか？
   - 答え: 継承。子供は人間の一種であり、子供クラスが人間クラスを継承することが適切です。