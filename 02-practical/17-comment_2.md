---
marp: true
math: mathjax
theme: katas
---
<!-- 
size: 16:9
paginate: true
-->
<!-- header: 勉強会# ― エンジニアとしての解像度を高めるための勉強会-->

# 読みやすいコードの作り方 - コメント(2)

_Code Readability_

---

## タネ本

### 『読みやすいコードのガイドライン<br>　 持続可能なソフトウェア開発のために』
* 石川宗寿(著)
* 技術評論社 2022/11/4初版

![bg right:30% 90%](assets/12-book.jpg)

---

## コメント

1. コメントの種類と目的
2. ドキュメンテーション **←ｲﾏｺｺ!**
3. 非形式的なコメント

---

<!-- p64 -->

## ドキュメンテーションコメント

コード中の宣言や定義に対して決められた書式で書くコメントのこと

* 関数・クラス・ファイルやパッケージなど
* プログラミング言語やドキュメンテーションツールによって異なる
    * Python(PyDoc): `""" 〜 """`, C++/C#系: `/** 〜 */`で括られたコメント
* APIリファレンスや、エディタ上でのクイックヒントなどに使われる

![center 25%](assets/16-docucomment_swift.png)

---

<!-- ここは本の3-2-2(p70)と少し先取りしているので注意 -->

## ドキュメンテーションの構成

ドキュメンテーションには要約と詳細とを書き、トップダウンで読み進められる内容を心がける

|パート|書くこと|
|---|---|
|**要約**|先頭行(段落)。コードが何であるのか・何をするのか(簡潔に)|
|**詳細**|基本的な使い方・戻り値の補足・制約やエラー時の動作<br>(どうやって使うか、何に注意するか分かりやすく)|

---

### ドキュメンテーションの例(Kotlin)

```kt
/**
 * キーワードとそれに対応する説明を、それぞれ文字列として保持する辞書クラス
 *
 * ...(詳細：基本的な使い方などを書く)...
 */
 class Dictionary {
    /**
     * [registerDescription]で登録済みの[keyword]に対する説明を取得する。
     *
     * ...(詳細：未定義のkeywordだった場合にどうなるかなどを書く)...
     */
    fun getDescription(keyword: String): String { ... }
 }
```

常体(普通体。だ・である調)と敬体(丁寧体。です・ます調)はプロジェクトで統一する

---

<!-- p65に戻る -->

## ドキュメンテーションコメントのアンチパターン

1. 自動生成されたドキュメンテーションの放置
2. 宣言と同じ内容を繰り返す
3. コードを自然言語に翻訳しただけ
4. 概要を書かない
5. 実装の詳細に言及する
6. コードを使う側の内容に言及する

---

### 1. 自動生成されたドキュメンテーションの放置

```kt
/** <<BAD>>
 * @param keyword
 * @return
 */
fun getDescription(keyword: String): String { … }
```

### 2. 宣言と同じ内容を繰り返す

```kt
/** <<BAD>>
 * [keyword] に対する説明を取得する。
 */
fun getDescription(keyword: String): String { … }
```

---

## 3. コードを自然言語に翻訳しただけ

```kt
/** <<BAD>>
 * もし`conditionA`が成り立つなら[doA]を呼び出す。
 * そうでないなら[doB]を呼び出し、さらにもし`conditionC`が成り立つなら …<snip>
 */
fun getDescription(keyword: String): String {
    if (conditionA) {
        doA()
    } else {
        doB()
        if (conditionC) { … }
    }
}
```

---

## 4. 概要を書かない

```kt
/** <<BAD>>
 * 与えられた[keyword]が空文字の場合は、例外を投げる。
 */
fun getDescription(keyword: String): String { … }
```

## 5. 実装の詳細に言及する

```kt
/** <<BAD>>
 * プライベートメンバーの[dictionary]が保持している文字列を返す。
 */
fun getDescription(keyword: String): String { … }
```

---

## 6. コードを使う側の内容に言及する

```kt
/** <<BAD>>
 * ・・・(概要)・・・
 * この関数は[UserProfilePresenter]によって使用される。
 */
fun getDescription(keyword: String): String { … }
```

---

## では何を書けばいいのか

* コードが何であるのか・何をするのかを最初に要約部で簡潔に説明する
    * 詳細部で具体的な内容に言及する
* 抽象度や粒度をコードよりも高く保つ
* 実装の詳細やコードを使う側には言及しない

<!-- 和田卓人氏が「コードコメントにはWhy notを書こう」という話をしたが、ドキュメンテーションにその記述は不要。何であるか、どういう使い方が出来るのかを説明するのが役割なので。 -->
