---
marp: true
math: mathjax
theme: katas
---
<!-- 
size: 16:9
paginate: true
-->
<!-- header: 勉強会# ― エンジニアとしての解像度を高めるための勉強会-->

### コンポーネントの原則 #0 & #1

# コンポーネントの原則 ― 導入 &

# 再利用・リリース等価の原則(REP)
_The Reuse/Release Equivalence Principle_

---
## タネ本

### 『クリーンアーキテクチャ<br>　 ― 達人に学ぶソフトウェアの構造と設計』
* Robert C. Martin(著), 角征典, 髙木正弘(訳)
* アスキードワンゴ刊
![bg right:30% 90%](assets/07-cleanarchitecture.jpg)

---

## コンポーネントの原則 vs. SOLID(設計の原則)

* **SOLID原則**: レンガを組み合わせて壁や部屋を作る方法
* **コンポーネントの原則**: 部屋を組み合わせて建物を作る方法

クラスやコードの粒度をコンポーネント(パッケージ、ライブラリ、ツール)に昇華したもの。複数の概念がまとまって存在するため、より複雑になる

<!-- SOLIDをスケールさせるだけのものもあれば、金槌とノコギリだけで建物は作れないように、部屋と建物の関係と同じようにSOLIDだけではない方法も存在する -->

---

## コンポーネントの原則

1. 再利用・リリース等価の原則(REP)
2. 閉鎖性共通の原則(CCP)
3. 全再利用の原則(CRP)
4. 非循環依存関係の原則(ADP)
5. 安定依存の原則(SDP)
6. 安定度・抽象度等価の原則(SAP)

1〜3: コンポーネントの凝集性
4〜6: コンポーネントの結合性

---

## 1.再利用・リリース等価の原則(REP)
_The Reuse/Release Equivalence Principle_

> **再利用の単位とリリースの単位は等価になる**

コンポーネントをリリースする時は利用者が再利用しやすいタイミングを考慮すべき


---

## 1.再利用・リリース等価の原則(REP)

いくつかの解釈があるので、ふわっと覚えたほうが良さそう

* 再利用の単位が、リリースの単位よりも小さくなることはない$^1$
* バージョン番号やリリースノートを使い再利用しやすく管理しなさい
* １リリースに含まれる構成物の粒度を、再利用の単位に合わせる

>>> アジャイルソフトウェア開発の奥義より

<!-- コンポーネント、ライブラリ、あるいはより抽象化したツールやアプリなどのように、自分たち以外の人間が使用することを考えるようにしましょう、という原則。再利用という言葉は、よくあるクラスを別の場所で再利用するというだけの話ではなく、あるライブラリを使っている人たちが、そのライブラリの依存バージョンを上げるというのも再利用の範疇に入る。

そのためには守るべきルールがいくつかあって、
* １つ目の話は、コンポーネント内のあるクラスだけver0.9を使い、このクラスにはver1.2を使うといったリリース以上の粒度を使い分けないと使用者の目的が果たせないという事態は避けるべき
* ２つ目は使用者が新しいバージョンを取り入れても良いかどうかを考えなさい
* ３つ目は、コンポーネントの中に含まれるものが利用者の再利用目的とぜんぜん関係ないものをコンポーネントの構成物に混ぜ込まない
というルールを守ることになる。 -->

---

## セマンティック・バージョニング$^1$

バージョン番号の付け方。
`メジャー.マイナー.パッチ`の、ピリオド`.`で区切られた３つの数字からなる文字列でソフトウェアのバージョンを管理する。

```py
0.1.0
0.8.4
0.10.0
1.0.0-beta.11
1.0.0+20240313144700
```
<br>

![center width:768px](assets/07-semantic_ver.png)

>>> 1.GitHubの共同創業者であるTom Preston-Werner氏が2010年に提唱。詳細は[公式ページ](https://semver.org/lang/ja/spec/v2.0.0.html)を参照

<!-- URLをチャットにも貼り付ける -->

---
## セマンティック・バージョニング

* **メジャーバージョン**:<br> APIに対して後方互換性を持たない変更が取り込まれた場合にインクリメント
* **マイナーバージョン**:<br> 後方互換性を保ちつつ機能をAPIに追加した場合、あるAPIを廃止予定とした場合にインクリメント
* **パッチバージョン**:<br> 後方互換性を保ったバグ修正を取り込んだ場合にインクリメント

※上位の値がインクリメントされたときには下位の値はリセットされる

<!-- 馴染みの深いバージョン体系であるため、一度見ておいた方が良い。コメント欄にもURLを貼り付けること -->

---

## エクササイズ: セマンティックバージョニング